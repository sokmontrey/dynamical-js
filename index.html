<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <!-- <script src="https://cdn.jsdelivr.net/gh/sokmontrey/dynamical-vector@master/dynamical-vector.js"></script> -->
    <script src="./src/util/dynamical_vector.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap');
        body{
            padding-top: 2rem;
            background-color: #2E3440;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .CodeMirror{
            font-size: 13px;
            font-family: 'JetBrains Mono', monospace;
            height: 80vh;
        }
        .CodeMirror-scroll {
            overflow-y: scroll;
            overflow-x: auto;
        }
        button{
            transition: all ease-in-out 0.3s;
        }
        select{
            outline: none;
            transition: all ease-in-out 0.3s;
        }
    </style>
</head>
<body>
    <div class="
    fixed bottom-0 right-0
    p-2
    ">
        <p style="font-family: 'JetBrains Mono'" 
        class="
        text-sm text-white
        ">Developed by Sokmontrey Sythat. 
            <a target="_blank" href="https://github.com/sokmontrey/dynamical-js"
            class="text-blue-400 underline">GitHub</a>
        </p>
    </div>

    <div class="
    flex space-x-6 justify-center
    mb-10
    text-white
    w-[10vw]
    ">
        <a class="text-[#88C0D0]">Home</a>
        <a href="/example/example.html">Example</a>
        <a href="/about.html">About</a>
    </div>

    <canvas id="canvas"></canvas>

    <script type="module">
        import Renderer from '../src/renderer.js';
        import PointMass from '../src/point_mass.js';
        import { CircleContainerConstraint, DistanceConstraint} from '../src/constraint.js';

        const canvas = document.getElementById('canvas');
        const renderer = new Renderer(canvas);
        renderer.setBackground('#2E3440');

        const c = renderer.context;
        const g = c.createLinearGradient(0,500,0,0);
        g.addColorStop(0, "rgba(255,255,255,0.5)");
        g.addColorStop(1, "rgba(46, 52, 64, 0.01)");


        c.font = "2rem 'JetBrains Mono'";
        const text_width = c.measureText("Dynamical").width;
        const text_width2 = c.measureText("JS").width;

        const points = [
            new PointMass(new Vector2(200, 150)),
            new PointMass(new Vector2(200 + text_width, 150)),
            new PointMass(new Vector2(200 + text_width + 100, 150)),
        ]

        const line = new DistanceConstraint(points);

        const container = new CircleContainerConstraint(200, [points[0], points[1]], new Vector2(50, -50));

        renderer.update(({delta_time, context: c})=>{
            renderer.clear();
            c.fillStyle = g;
            renderer.point(container._center,container._radius);

            for(let each of points){
                each.applyGravity(0, 9.8);
            }
            for(let i=0; i<3; i++){
                line.check();
                container.check();
                for(let each of points){
                    each.updatePosition(delta_time*0.55);
                }
            }

            renderer.line(points[1].position, points[2].position, 2, {stroke: 'gray'});
            renderer.point(points[2].position, 5);

            c.fillStyle='white';
            const angle = Math.atan2(points[1].position.y - points[0].position.y, points[1].position.x - points[0].position.x);
            c.translate(points[0].position.x, points[0].position.y);
            c.rotate(angle);
            c.fillText('Dynamical', 0, 0);
            c.setTransform(1, 0, 0, 1, 0, 0);

            c.fillText('JS', points[2].position.x - text_width2/2, points[2].position.y + text_width2);
        });

    </script>
</body>
</html>
