<html>
  <head>
    <meta charset="utf-8" />
    <title>Shape</title>
  </head>
  <body>
    <canvas width="500" height="500" id="canvas"></canvas>
    <script type="module">
      import {
        Shape,
        Container,
        CircleContainer,
        PointMass,
        Renderer,
        Vector,
        Line,
      } from "../index.js";

      const canvas = document.getElementById("canvas");
      const renderer = new Renderer(canvas);
      renderer.setBackgroundColor("black");

      /*
      TODO:
      - [x] create shape from pointmasses
      - [x] create shape from vertices (removed)
      - [x] draw shape
      - [x] create shape from relative (localized) vertices
      - [x] create shape from number of sides
      - [] get center of mass position
      - [] draw center of mass
      - [] set position
      - [] set velocity
      - [] apply force
      - [] Sub shapes
      - [] rotation
      TESTS:
      */

      const cube = Shape.fromVertices(
        [
          new Vector(-30, -30),
          new Vector(30, -30),
          new Vector(30, 30),
          new Vector(-30, 30),
        ],
        new Vector(100, 100),
      );
      const cube2 = Shape.fromSides(5, 30, new Vector(250, 250));

      const container = new CircleContainer(
        cube.getPointMasses().concat(cube2.getPointMasses()),
      );

      renderer.loop((dt) => {
        renderer.clear();

        for (let i = 0; i < 10; i++) {
          cube.applyForce(new Vector(0, 9));
          cube.update(0.25, 10);

          cube2.applyForce(new Vector(0, 9));
          cube2.update(0.25, 10);

          container.update(10);
        }

        // cube.getPointMasses().forEach((pm) => pm.position.graphic.draw(renderer));
        container.graphic.draw(renderer);
        cube.graphic.draw(renderer);
        cube2.graphic.draw(renderer);
        // cube
        //   .getDistanceConstraints()
        //   .forEach((dc) => dc.graphic.draw(renderer));
        // cube.getAngleConstraints().forEach((ac) => ac.graphic.draw(renderer));
      });
    </script>
  </body>
</html>
