<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example2</title>

    <style>
        body{
            background-color: #191c22;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script type="module">
        import { Vector } from '../src/util/dynamical_vector.js';
        import PointMass from '../src/point_mass.js';
        import Renderer from '../src/renderer.js';
        import Constraint, { Container, CircleContainer } from '../src/constraint.js';
        import Composite, {Rectangle} from '../src/composite.js';
        import Collider from '../src/collider.js';
        import Camera from '../src/camera.js';

        const canvas = document.getElementById('canvas');
        const renderer = new Renderer(canvas);

        renderer.setBackground('#252422');

        const c = new CircleContainer().setName("ground");

        const cube1 = Composite.create('square', {
            position: new Vector(250, 100),
            angle: Math.PI/5,
        }).setName("cube1");

        const circle = Composite.create('circle', {
            radius: 20,
            position: new Vector(100, 100)
        })

        const rect = new Rectangle(250, 10, 10, 20);

        const point = new PointMass(250, 250);

        let t = 1;
        renderer.update((delta_time)=>{
            t ++;
            renderer.clear();

            //apply force
            //constraint
            //Container
            //collider
            //update position
            //draw

            delta_time /= 10;
            for(let i=0; i<10; i++){
                cube1.applyGravity();
                circle.applyGravity();
                rect.applyGravity();
                point.applyGravity();

                cube1.applyConnections();
                rect.applyConnections();

                c.check(cube1);
                c.check(circle);
                c.check(rect);
                c.check(point);

                Collider.check(circle, cube1);
                Collider.check(circle, rect);
                Collider.check(rect, cube1);

                cube1.updatePosition(delta_time);
                circle.updatePosition(delta_time);
                rect.updatePosition(delta_time);
                point.updatePosition(delta_time);
            }

            renderer.camera.moveTo(point.getPosition());

            renderer.draw(cube1);
            renderer.draw(circle);
            renderer.draw(rect);
            renderer.draw(point);
            renderer.draw(c);
        });
    </script>
</body>
</html>
